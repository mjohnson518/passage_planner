# Railway / Nixpacks build configuration
# Ensures Node 20, proper build order for monorepo

[phases.setup]
nixPkgs = ["...", "pkgs.nodejs-20_x"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = [
  "npm run build:shared",
  "npm run build --workspace=@passage-planner/orchestrator"
]

[start]
cmd = "node orchestrator/dist/index.js"
